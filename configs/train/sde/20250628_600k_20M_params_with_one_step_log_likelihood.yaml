experiment:
  name: 600k_continued_from_3_days_with_one_step_log_likelihood
  name_add_date: true # if true, the current date & time will be added to the experiment name
  seed: 10
  device_map: cuda # auto, cuda, cpu

distributed:
  enabled: true # true for multi gpu training
  sharding_strategy: NO_SHARD # SHARD_GRAD_OP, NO_SHARD (data parallelism), HYBRID_SHARD
  wrap_policy: SIZE_BAZED # NO_POLICY # MODEL_SPECIFIC, SIZE_BAZED (decides how to split parameters along GPUs)
  min_num_params: 1e5
  checkpoint_type: full_state # full_state, local_state
  activation_chekpoint: false

model:
  model_type: fimsde
  ###################################################################################
  # Input data (corrected by dataloader)
  max_dimension: &max_dimension 3
  # max_time_steps: &max_time_steps 128
  # max_location_size: &max_location_size 1024
  # max_num_paths: &max_num_of_paths 300

  # General model config
  non_negative_diffusion_by: softplus
  model_embedding_size: &model_embedding_size 256

  # General transformer config
  residual_ff_size: &residual_ff_size 1024
  transformer_layer_activation: &transformer_layer_activation "gelu"

  # General MLP config
  hidden_layers: &hidden_layers !!python/tuple [256, 256]
  dropout_rate: &dropout_rate 0.1
  hidden_act: &hidden_act
    name: &activation torch.nn.GELU

  # Networks
  layer_norms_in_phi_0: false
  separate_phi_0_encoders: true
  delta_time_only: true

  phi_0t:
    name: torch.nn.Linear

  phi_0x:
    name: torch.nn.Linear

  psi_1:
    name: "CombinedPathTransformer"
    num_layers: 2
    layer:
      attn_method: "linear"
      lin_feature_map: "softmax"
      lin_normalize: false
      nhead: &nhead 8
      dim_feedforward: *residual_ff_size
      dropout: *dropout_rate
      activation: *activation

  phi_1x:
    name: torch.nn.Linear

  learn_vf_var: false
  operator_specificity: "per_concept" # all, per_concept, per_head

  operator: &operator
    paths_block_attention: false
    num_res_layers: 8
    attention:
      nhead: *nhead
      dim_feedforward: *residual_ff_size
      dropout: *dropout_rate
      activation: *activation

    projection:
      name: fim.models.blocks.base.MLP
      hidden_layers: *hidden_layers
      hidden_act: *hidden_act
      dropout: *dropout_rate


  # instance normalization
  states_norm:
    name: fim.models.sde.Standardization

  times_norm_on_deltas: True
  times_norm:
    name: fim.models.sde.DeltaLogCentering

  # loss regularization
  train_with_normalized_head: true
  loss_filter_nans: true

  # learnable_loss_scales: *operator
  learnable_loss_scales:
    paths_block_attention: false
    num_res_layers: 8
    attention:
      nhead: *nhead
      dim_feedforward: *residual_ff_size
      dropout: *dropout_rate
      activation: *activation

    projection:
      name: fim.models.blocks.base.MLP
      hidden_layers: *hidden_layers
      hidden_act: *hidden_act
      dropout: *dropout_rate


  # loss
  loss_type: "mse" #nll, rmse, nrmse
  divide_drift_loss_by_diffusion: false
  single_learnable_loss_scale_head: true
  detach_learnable_loss_scale_heads: true
  one_step_ahead_loss_obs: 16


  # INFERENCE/PIPELINE ------------------------------------------------------------
  dt_pipeline: 0.1
  number_of_time_steps_pipeline: 128
  evaluate_with_unnormalized_heads: true

dataset:
  name: FIMSDEDataloaderIterableDataset

  max_dim: 3

  dataset_name:
    train: &train_set_name StreamingFIMSDEDataset # PaddedFIMSDEDataset, HeterogeneousFIMSDEDataset, StreamingFIMSDEDataset
    validation: *train_set_name
    test: HeterogeneousFIMSDEDataset

  batch_size:
    train: &train_batch_size 16
    validation: *train_batch_size
    test: 128

  shard:
    train: true
    validation: true
    test: false

  # data_limit:
  #   train: 10
  #   validation: 10
  #   test: 10

  shuffle_locations:
    train: true
    validation: true
    test: false

  add_paths_keys: !!python/tuple ["obs_values_clean"]
  add_dim_keys:  !!python/tuple ["obs_values_clean"]

  shuffle_paths: true
  shuffle_elements: true # only for PaddedFIMSDEDataset and HeterogeneousFIMSDEDataset

  num_locations:
    train: 32
    validation: 32
    test: null

  num_observations:
    train: &train_num_obs !!python/tuple [128, 12800]
    validation: *train_num_obs
    test: null

  num_workers:
    train: 16
    validation: 8
    test: 0

  files_to_load:
    obs_times: "obs_times.h5"
    obs_values_clean: "obs_values.h5" # for one step ahead likelihood loss
    obs_values: "obs_noisy_values.h5" # for clean data, obs_noisy_values is obs_values
    obs_mask: "obs_mask.h5"
    locations: "locations.h5"
    drift_at_locations: "drift_at_locations.h5"
    diffusion_at_locations: "diffusion_at_locations.h5"

  data_dirs:
    train: !!python/tuple [
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_1_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_1_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_1_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_1_add_10_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_1_add_10_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_1_add_10_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_1_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_1_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_1_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_add_10_and_drop_20_perc_chunk_1/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_add_10_and_drop_20_perc_chunk_1/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_add_10_and_drop_20_perc_chunk_1/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_add_10_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_add_10_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_add_10_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_add_10_perc_chunk_1/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_add_10_perc_chunk_1/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_add_10_perc_chunk_1/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_drop_20_perc_chunk_1/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_drop_20_perc_chunk_1/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_2_drop_20_perc_chunk_1/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_and_drop_20_perc_chunk_1/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_and_drop_20_perc_chunk_1/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_and_drop_20_perc_chunk_1/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_and_drop_20_perc_chunk_2/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_and_drop_20_perc_chunk_2/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_and_drop_20_perc_chunk_2/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_perc_chunk_1/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_perc_chunk_1/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_perc_chunk_1/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_perc_chunk_2/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_perc_chunk_2/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_add_10_perc_chunk_2/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_drop_20_perc_chunk_1/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_drop_20_perc_chunk_1/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_drop_20_perc_chunk_1/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_drop_20_perc_chunk_2/delta_tau_1e-1_100_paths_length_128_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_drop_20_perc_chunk_2/delta_tau_1e-2_25_paths_length_512_num_realiz_5433,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/16k_train_dim_3_drop_20_perc_chunk_2/delta_tau_1e-3_12_paths_length_1024_num_realiz_5433,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_1_clean_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_1_clean_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_1_clean_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_8333,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_1_clean_chunk_1/delta_tau_1e-1_100_paths_length_128_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_1_clean_chunk_1/delta_tau_1e-2_25_paths_length_512_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_1_clean_chunk_1/delta_tau_1e-3_12_paths_length_1024_num_realiz_8333,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_2_clean_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_2_clean_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_2_clean_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_8333,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_2_clean_chunk_1/delta_tau_1e-1_100_paths_length_128_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_2_clean_chunk_1/delta_tau_1e-2_25_paths_length_512_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_2_clean_chunk_1/delta_tau_1e-3_12_paths_length_1024_num_realiz_8333,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_2_clean_chunk_2/delta_tau_1e-1_100_paths_length_128_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_2_clean_chunk_2/delta_tau_1e-2_25_paths_length_512_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_2_clean_chunk_2/delta_tau_1e-3_12_paths_length_1024_num_realiz_8333,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_2_clean_chunk_3/delta_tau_1e-1_100_paths_length_128_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_2_clean_chunk_3/delta_tau_1e-2_25_paths_length_512_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_2_clean_chunk_3/delta_tau_1e-3_12_paths_length_1024_num_realiz_8333,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_8333,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_1/delta_tau_1e-1_100_paths_length_128_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_1/delta_tau_1e-2_25_paths_length_512_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_1/delta_tau_1e-3_12_paths_length_1024_num_realiz_8333,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_2/delta_tau_1e-1_100_paths_length_128_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_2/delta_tau_1e-2_25_paths_length_512_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_2/delta_tau_1e-3_12_paths_length_1024_num_realiz_8333,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_3/delta_tau_1e-1_100_paths_length_128_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_3/delta_tau_1e-2_25_paths_length_512_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_3/delta_tau_1e-3_12_paths_length_1024_num_realiz_8333,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_4/delta_tau_1e-1_100_paths_length_128_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_4/delta_tau_1e-2_25_paths_length_512_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_4/delta_tau_1e-3_12_paths_length_1024_num_realiz_8333,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_5/delta_tau_1e-1_100_paths_length_128_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_5/delta_tau_1e-2_25_paths_length_512_num_realiz_8333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/train/25k_train_dim_3_clean_chunk_5/delta_tau_1e-3_12_paths_length_1024_num_realiz_8333, ]

    test: !!python/tuple [
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/10k_test_dim_2_clean_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_3333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/10k_test_dim_2_clean_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_3333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/10k_test_dim_2_clean_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_3333,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/15k_test_dim_3_clean_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_4999,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/15k_test_dim_3_clean_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_4999,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/15k_test_dim_3_clean_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_4999,

      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/1_6k_test_dim_1_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_543,
      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/1_6k_test_dim_1_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_543,
      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/1_6k_test_dim_1_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_543,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/1_6k_test_dim_1_add_10_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_543,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/1_6k_test_dim_1_add_10_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_543,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/1_6k_test_dim_1_add_10_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_543,

      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/1_6k_test_dim_1_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_543,
      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/1_6k_test_dim_1_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_543,
      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/1_6k_test_dim_1_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_543,

      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/3_3k_test_dim_2_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_1109,
      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/3_3k_test_dim_2_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_1109,
      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/3_3k_test_dim_2_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_1109,

      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/3_3k_test_dim_2_add_10_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_1109,
      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/3_3k_test_dim_2_add_10_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_1109,
      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/3_3k_test_dim_2_add_10_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_1109,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/3_3k_test_dim_2_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_1109,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/3_3k_test_dim_2_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_1109,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/3_3k_test_dim_2_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_1109,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/5k_test_dim_1_clean_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_1666,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/5k_test_dim_1_clean_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_1666,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/5k_test_dim_1_clean_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_1666,

      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/5k_test_dim_3_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_1666,
      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/5k_test_dim_3_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_1666,
      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/5k_test_dim_3_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_1666,

      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/5k_test_dim_3_add_10_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_1666,
      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/5k_test_dim_3_add_10_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_1666,
      # /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/5k_test_dim_3_add_10_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_1666,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/5k_test_dim_3_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_1666,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/5k_test_dim_3_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_1666,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/test/5k_test_dim_3_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_1666,
       ]

    validation: !!python/tuple [
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/10k_validation_dim_2_clean_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_3333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/10k_validation_dim_2_clean_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_3333,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/10k_validation_dim_2_clean_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_3333,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/15k_validation_dim_3_clean_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_4999,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/15k_validation_dim_3_clean_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_4999,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/15k_validation_dim_3_clean_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_4999,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/1_6k_validation_dim_1_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_543,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/1_6k_validation_dim_1_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_543,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/1_6k_validation_dim_1_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_543,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/1_6k_validation_dim_1_add_10_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_543,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/1_6k_validation_dim_1_add_10_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_543,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/1_6k_validation_dim_1_add_10_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_543,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/1_6k_validation_dim_1_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_543,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/1_6k_validation_dim_1_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_543,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/1_6k_validation_dim_1_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_543,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/3_3k_validation_dim_2_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_1109,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/3_3k_validation_dim_2_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_1109,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/3_3k_validation_dim_2_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_1109,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/3_3k_validation_dim_2_add_10_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_1109,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/3_3k_validation_dim_2_add_10_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_1109,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/3_3k_validation_dim_2_add_10_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_1109,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/3_3k_validation_dim_2_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_1109,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/3_3k_validation_dim_2_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_1109,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/3_3k_validation_dim_2_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_1109,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/5k_validation_dim_1_clean_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_1666,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/5k_validation_dim_1_clean_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_1666,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/5k_validation_dim_1_clean_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_1666,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/5k_validation_dim_3_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_1666,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/5k_validation_dim_3_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_1666,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/5k_validation_dim_3_add_10_and_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_1666,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/5k_validation_dim_3_add_10_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_1666,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/5k_validation_dim_3_add_10_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_1666,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/5k_validation_dim_3_add_10_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_1666,

      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/5k_validation_dim_3_drop_20_perc_chunk_0/delta_tau_1e-1_100_paths_length_128_num_realiz_1666,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/5k_validation_dim_3_drop_20_perc_chunk_0/delta_tau_1e-2_25_paths_length_512_num_realiz_1666,
      /raid/seifner/sde_train_data/20250309_600k_polynomials_drift_deg_3_diffusion_deg_2_100_paths_half_with_noise_delta_tau_1e-1_to_1e-3/validation/5k_validation_dim_3_drop_20_perc_chunk_0/delta_tau_1e-3_12_paths_length_1024_num_realiz_1666,
       ]


trainer:
  name: Trainer
  debug_iterations: null
  precision: bf16mixed # null fp16 bf16 bf16_mixed fp16_mixed fp32_policy (stick to bf16, maybe try bf16_mixed for more accurate gradients)
  epochs: &epochs 2000
  detect_anomaly: false
  save_every: 1
  gradient_accumulation_steps: 1
  best_metric: loss
  logging_format: "RANK_%(rank)s - %(asctime)s - %(name)s - %(levelname)s - %(message)s"
  experiment_dir: ./results/
  # profiler:
  #   num_batches: 40
  #   trace_path: "/home/seifner/repos/FIM/results/profiler/trace.json"

  evaluation_epoch:
    path: fim.trainers.evaluation_epochs.SDEEvaluationPlots
    plot_frequency: 1
    plot_paths_count: 50

  schedulers: !!python/tuple
    - name: fim.utils.param_scheduler.ConstantScheduler # ExponentialIncrease, ConstantScheduler, PeriodicScheduler
      label: loss_threshold
      beta: 1000000000.0

    - name: fim.utils.param_scheduler.ConstantScheduler # ExponentialIncrease, ConstantScheduler, PeriodicScheduler
      label: vector_field_max_norm
      beta: 1000000000.0

    - name: fim.utils.param_scheduler.ConstantScheduler # ExponentialIncrease, ConstantScheduler, PeriodicScheduler
      label: drift_loss_scale
      beta: 1.0

    - name: fim.utils.param_scheduler.ConstantScheduler # ExponentialIncrease, ConstantScheduler, PeriodicScheduler
      label: diffusion_loss_scale
      beta: 1.0

    - name: fim.utils.param_scheduler.ConstantScheduler # ExponentialIncrease, ConstantScheduler, PeriodicScheduler
      label: kl_loss_scale
      beta: 0.0

    - name: fim.utils.param_scheduler.ConstantScheduler # ExponentialIncrease, ConstantScheduler, PeriodicScheduler
      label: one_step_nll_loss_scale
      beta: 1.0

    - name: fim.utils.param_scheduler.ConstantScheduler # ExponentialIncrease, ConstantScheduler, PeriodicScheduler
      label: short_time_transition_log_likelihood_loss_scale
      beta: 0.0

optimizers: !!python/tuple
  - optimizer_d: # name of the optimizer
      name: torch.optim.AdamW
      lr: &lr_rate 1.0e-5
      weight_decay: 1.0e-4
      gradient_norm_clipping: 1
      # schedulers: !!python/tuple
      #   - name: torch.optim.lr_scheduler.SequentialLR
      #     step_type: minibatch
      #     schedulers: !!python/tuple
      #       - name: fim.trainers.lr_warmup.LinearWarmupScheduler
      #         warmup_steps: &warmup_steps 10000
      #         target_lr: *lr_rate
      #       # - name: torch.optim.lr_scheduler.CosineAnnealingLR
      #       #   T_max: 450000
      #       #   eta_min: 1.0e-7
      #       #   last_epoch: -1
      #     milestones: !!python/tuple []
